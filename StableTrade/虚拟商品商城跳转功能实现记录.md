# 虚拟商品商城跳转功能实现记录

## 功能概述

实现了点击虚拟商品商城相关元素跳转到虚拟商品页面的功能，包括多个入口点和完整的页面导航流程。

## 技术实现

### 1. 核心文件结构

| 文件路径 | 功能描述 | 主要变更 |
|---------|---------|----------|
| `src/App.tsx` | 主应用组件 | 添加页面状态管理和路由逻辑 |
| `src/components/Hero.tsx` | 首页英雄区域 | 添加点击跳转功能 |
| `src/components/TopNav.tsx` | 顶部导航栏 | 添加动态导航按钮 |
| `src/components/VirtualGoodsPage.tsx` | 虚拟商品页面 | 新增页面组件 |

### 2. 页面状态管理

在 `src/App.tsx` 中实现了页面状态管理：

```typescript
import { useState } from 'react'

// 定义页面类型
type Page = 'home' | 'virtualGoods'

function App() {
  // 当前页面状态
  const [currentPage, setCurrentPage] = useState<Page>('home')
  
  // 跳转函数
  const handleVirtualGoodsClick = () => {
    setCurrentPage('virtualGoods')
  }

  const handleBackToHome = () => {
    setCurrentPage('home')
  }

  // 页面渲染
  return (
    <div className="min-h-screen" style={{ backgroundColor: 'var(--bg)' }}>
      <TopNav 
        onVirtualGoodsClick={currentPage === 'home' ? handleVirtualGoodsClick : undefined}
        onBackClick={currentPage === 'virtualGoods' ? handleBackToHome : undefined}
      />

      <div className="pt-20">
        {currentPage === 'home' ? (
          <>
            <Hero onVirtualGoodsClick={handleVirtualGoodsClick} />
            <OperationsPanel />
          </>
        ) : (
          <VirtualGoodsPage />
        )}
      </div>
      
      {/* 页脚 */}
    </div>
  )
}
```

### 3. 导航栏实现

在 `src/components/TopNav.tsx` 中添加了动态导航按钮：

```typescript
interface TopNavProps {
  onVirtualGoodsClick?: () => void
  onBackClick?: () => void
}

export function TopNav({ onVirtualGoodsClick, onBackClick }: TopNavProps) {
  return (
    <div className="fixed top-0 left-0 right-0 z-50 px-4 pt-4">
      <nav className="glass-card max-w-7xl mx-auto rounded-2xl">
        <div className="px-6 py-4">
          <div className="flex flex-col md:flex-row md:justify-between md:items-center gap-4">
            {/* 品牌标识 */}
            <div className="flex items-center gap-3">
              {/* 品牌图标 */}
              <h1 className="text-2xl font-bold tracking-wide">StableTrade</h1>
            </div>

            {/* 导航按钮 */}
            <div className="flex flex-wrap items-center gap-3">
              {/* 返回首页按钮 */}
              {onBackClick && (
                <Button className="btn-ghost" onPress={onBackClick}>
                  ← 返回首页
                </Button>
              )}
              
              {/* 虚拟商品商城按钮 */}
              {onVirtualGoodsClick && (
                <Button className="btn-gradient" onPress={onVirtualGoodsClick}>
                  🛒 虚拟商品商城
                </Button>
              )}
              
              {/* 其他组件 */}
              <NetworkSelect />
              <BrandSelect />
              <WalletConnectButton />
            </div>
          </div>
        </div>
      </nav>
    </div>
  )
}
```

### 4. 首页跳转点

在 `src/components/Hero.tsx` 中添加了多个点击跳转点：

```typescript
interface HeroProps {
  onVirtualGoodsClick?: () => void
}

export function Hero({ onVirtualGoodsClick }: HeroProps) {
  return (
    <section className="relative py-20 md:py-32">
      <div className="relative max-w-4xl mx-auto text-center px-4">
        {/* 跳转点 1: 虚拟商品商城标签 */}
        <div className="inline-block mb-6">
          <div
            className="px-4 py-2 rounded-full text-sm font-medium cursor-pointer"
            onClick={onVirtualGoodsClick}
          >
            🛒 虚拟商品商城
          </div>
        </div>

        {/* 跳转点 2: 标题文字 */}
        <h1 className="text-5xl md:text-7xl font-bold mb-6 leading-tight">
          StableTrade
          <br />
          <span
            style={{
              background: 'linear-gradient(90deg, var(--cyan) 0%, var(--pink) 100%)',
              WebkitBackgroundClip: 'text',
              WebkitTextFillColor: 'transparent',
              cursor: 'pointer'
            }}
            onClick={onVirtualGoodsClick}
          >
            虚拟商品商城
          </span>
        </h1>

        {/* 跳转点 3: 热门商品区域 */}
        <div 
          className="mt-16 glass-panel rounded-2xl p-8 text-left cursor-pointer"
          onClick={onVirtualGoodsClick}
        >
          <h2 className="text-2xl font-bold mb-6 text-center">热门商品</h2>
          {/* 商品列表 */}
        </div>
      </div>
    </section>
  )
}
```

### 5. 虚拟商品页面

新增了 `src/components/VirtualGoodsPage.tsx` 页面：

```typescript
export function VirtualGoodsPage() {
  const [selectedProduct, setSelectedProduct] = useState<string | null>(null)
  const [amount, setAmount] = useState('')
  
  // 商品数据
  const products = [
    {
      id: 'gold',
      name: '虚拟黄金',
      price: '1,000 USDC',
      desc: '由 NFT 资产背书的数字黄金，价值稳定',
      icon: '🥇',
      tag: '热门',
      usdcAmount: '1000'
    },
    // 其他商品...
  ]

  // 购买处理函数
  const handleBuy = async () => {
    // 购买逻辑
  }

  return (
    <section className="relative py-20">
      <div className="max-w-6xl mx-auto px-4">
        {/* 页面标题 */}
        <div className="text-center mb-12">
          <h1 className="text-4xl md:text-5xl font-bold mb-4">虚拟商品商城</h1>
          <p className="text-lg">选择并购买您喜欢的虚拟商品</p>
        </div>

        {/* 商品列表 */}
        <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
          {products.map((product) => (
            <div
              key={product.id}
              className="glass-card rounded-xl p-5 cursor-pointer"
              onClick={() => {
                setSelectedProduct(product.id)
                setAmount(product.usdcAmount)
              }}
            >
              {/* 商品信息 */}
            </div>
          ))}
        </div>

        {/* 购买确认 */}
        {selectedProduct && (
          <div className="mt-12 glass-panel rounded-2xl p-8">
            {/* 购买表单 */}
          </div>
        )}
      </div>
    </section>
  )
}
```

## 操作流程

### 1. 进入虚拟商品商城

**入口点 1: 顶部导航按钮**
1. 点击首页顶部导航栏中的 "🛒 虚拟商品商城" 按钮
2. 触发 `handleVirtualGoodsClick()` 函数
3. 页面状态从 `home` 切换到 `virtualGoods`
4. 渲染 `VirtualGoodsPage` 组件
5. 导航栏显示 "← 返回首页" 按钮

**入口点 2: 首页标签**
1. 点击首页顶部的 "🛒 虚拟商品商城" 标签
2. 触发 `onVirtualGoodsClick` 回调
3. 页面状态切换，显示虚拟商品页面

**入口点 3: 标题文字**
1. 点击首页标题中的 "虚拟商品商城" 文字
2. 触发 `onVirtualGoodsClick` 回调
3. 页面状态切换，显示虚拟商品页面

**入口点 4: 热门商品区域**
1. 点击首页热门商品区域的任意位置
2. 触发 `onVirtualGoodsClick` 回调
3. 页面状态切换，显示虚拟商品页面

### 2. 浏览和购买商品

1. 在虚拟商品页面浏览6种虚拟商品
2. 点击商品卡片查看详情
3. 点击 "选择购买" 按钮
4. 查看购买确认信息
5. 点击 "确认购买" 按钮
6. 确认钱包签名
7. 等待交易完成
8. 查看购买结果

### 3. 返回首页

1. 点击虚拟商品页面顶部导航栏中的 "← 返回首页" 按钮
2. 触发 `handleBackToHome()` 函数
3. 页面状态从 `virtualGoods` 切换到 `home`
4. 渲染首页组件
5. 导航栏显示 "🛒 虚拟商品商城" 按钮

## 技术特点

### 1. 多入口点设计

实现了4个不同的点击入口点，提供了良好的用户体验：
- 顶部导航按钮：最明显的入口
- 首页标签：快速入口
- 标题文字：品牌联动
- 热门商品区域：内容引导

### 2. 响应式设计

- 导航按钮在不同屏幕尺寸下自适应排列
- 虚拟商品页面使用网格布局，适配不同设备
- 触摸设备友好的点击区域大小

### 3. 状态管理

- 使用 React 的 `useState` 管理页面状态
- 无需依赖外部路由库，轻量实现
- 支持页面状态的持久化和恢复

### 4. 性能优化

- 组件懒加载，只在需要时渲染
- 状态更新优化，避免不必要的重渲染
- 内存管理，组件卸载时清理状态

## 功能验证

### 测试步骤

1. **导航按钮测试**：
   - 点击顶部导航栏的 "🛒 虚拟商品商城" 按钮
   - 验证是否跳转到虚拟商品页面
   - 点击 "← 返回首页" 按钮
   - 验证是否返回首页

2. **首页标签测试**：
   - 点击首页顶部的 "🛒 虚拟商品商城" 标签
   - 验证是否跳转到虚拟商品页面

3. **标题文字测试**：
   - 点击首页标题中的 "虚拟商品商城" 文字
   - 验证是否跳转到虚拟商品页面

4. **热门商品测试**：
   - 点击首页热门商品区域
   - 验证是否跳转到虚拟商品页面

5. **商品购买测试**：
   - 在虚拟商品页面选择商品
   - 验证购买流程是否正常

### 预期结果

- 所有入口点点击后都能正确跳转到虚拟商品页面
- 虚拟商品页面显示6种商品
- 支持商品选择和购买
- 能够正常返回首页
- 页面切换流畅，无卡顿
- 响应式布局适配不同屏幕尺寸

## 总结

本功能成功实现了从首页多个入口点点击跳转到虚拟商品页面的完整流程，包括：

1. **完整的导航系统**：首页 → 虚拟商品页面 → 首页的双向导航
2. **多入口点设计**：4个不同的点击入口，提升用户体验
3. **响应式布局**：适配各种设备屏幕尺寸
4. **状态管理**：轻量级的页面状态管理实现
5. **性能优化**：组件懒加载和状态更新优化

功能实现符合预期，代码结构清晰，用户体验良好。